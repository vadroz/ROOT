<%@ page import="agedanalysis.OpenToBuyEOY, java.util.*"%>
<% String sStore = request.getParameter("STORE");
   String sDivision = request.getParameter("DIVISION");
   String sDivName = request.getParameter("DIVNAME");
   String sDepartment = request.getParameter("DEPARTMENT");
   String sDptName = request.getParameter("DPTNAME");
   String sClass = request.getParameter("CLASS");
   String sClsName = request.getParameter("CLSNAME");

   if(sStore == null) sStore = "ALL";
   if(sDivision == null) sDivision = "ALL";
   if(sDivName == null) sDivName = "All Divisions";
   if(sDepartment == null) sDepartment = "ALL";
   if(sDptName == null) sDptName = "All Departments";
   if(sClass == null) sClass = "ALL";
   if(sClsName == null) sClsName = "All Classes";

   //System.out.println(sStore  + " " + sDivision + " " + sDepartment + " " + sClass );
   OpenToBuyEOY opnbuy = new OpenToBuyEOY(sStore, sDivision, sDepartment, sClass, "N");

   int iNumOfGrp = opnbuy.getNumOfGrp();
   String [] sGrp = opnbuy.getGrp();
   String [] sGrpName = opnbuy.getGrpName();
   String [] sBegInv = opnbuy.getBegInv();
    String [] sEndInvA = opnbuy.getEndInvA();
    String [] sEndInvB = opnbuy.getEndInvB();
    String [] sEndVar = opnbuy.getEndVar();
    String [] sLessA = opnbuy.getLessA();
    String [] sLessB = opnbuy.getLessB();
    String [] sLessVar = opnbuy.getLessVar();
    String [] sMosA = opnbuy.getMosA();
    String [] sMosB = opnbuy.getMosB();
    String [] sMosVar = opnbuy.getMosVar();
    String [] sOpnRcvA = opnbuy.getOpnRcvA();
    String [] sOpnRcvB = opnbuy.getOpnRcvB();
    String [] sOpnRcvVar = opnbuy.getOpnRcvVar();

    String sTotal = opnbuy.getTotal();
    String sTotBegInv = opnbuy.getTotBegInv();
    String sTotEndInvA = opnbuy.getTotEndInvA();
    String sTotEndInvB = opnbuy.getTotEndInvB();
    String sTotEndVar = opnbuy.getTotEndVar();
    String sTotLessA = opnbuy.getTotLessA();
    String sTotLessB = opnbuy.getTotLessB();
    String sTotLessVar = opnbuy.getTotLessVar();
    String sTotMosA = opnbuy.getTotMosA();
    String sTotMosB = opnbuy.getTotMosB();
    String sTotMosVar = opnbuy.getTotMosVar();
    String sTotOpnRcvA = opnbuy.getTotOpnRcvA();
    String sTotOpnRcvB = opnbuy.getTotOpnRcvB();
    String sTotOpnRcvVar = opnbuy.getTotOpnRcvVar();

   opnbuy.disconnect();

   String sColName = "Division";
   if(!sClass.trim().equals("ALL")) sColName = "Class";
   else if(!sDepartment.trim().equals("ALL")) sColName = "Class";
   else if(!sDivision.trim().equals("ALL")) sColName = "Department";
 %>

<html>
<head>

<style>
     body { background:ivory;}
        a:link { color:blue; font-size:12px } a:visited { color:blue; font-size:12px }  a:hover { color:blue; font-size:12px }
        a.blue:link { color:blue; font-size:10px } a:visited { color:blue; font-size:10px }  a:hover { color:red; font-size:10px }
        table.DataTable { border: darkred solid 1px;background:darkred;text-align:center;}
        th.DataTable { background:#FFCC99;padding-top:3px; padding-bottom:3px; border-bottom: darkred solid 1px;border-right: darkred solid 1px;text-align:center; font-family:Verdanda; font-size:12px }

        th.InvData { background:#FFCC99;padding-top:3px; padding-bottom:3px; border-bottom: darkred solid 1px;border-right: darkred solid 1px;text-align:center; font-family:Verdanda; font-size:12px }
        td.InvData { padding-top:3px; padding-bottom:3px; padding-left:3px;
                       padding-right:3px; border-bottom: darkred solid 1px; border-right: darkred solid 1px; text-align:right;}


        tr.DataTable { background:#EfEfEf; font-family:Arial; font-size:10px }
        tr.DataTable1 { background:white; font-family:Arial; font-size:10px }
        tr.DataTable2 { background:CornSilk; font-family:Arial; font-size:10px }

        td.DataTable { padding-top:3px; padding-bottom:3px; padding-left:3px;
                       padding-right:3px; border-bottom: darkred solid 1px; border-right: darkred solid 1px; text-align:right;}
        td.DataTable1 { padding-top:3px; padding-bottom:3px; padding-left:3px;
                       padding-right:3px; border-bottom: darkred solid 1px; border-right: darkred solid 1px; text-align:left;}
        td.DataTable2 { padding-top:3px; padding-bottom:3px; padding-left:3px;
                       padding-right:3px; border-bottom: darkred solid 1px; border-right: darkred solid 1px; text-align:center;}
        td.DataTable3 {color:blue; cursor: hand; padding-top:3px; padding-bottom:3px; padding-left:3px;
                       padding-right:3px; border-bottom: darkred solid 1px; border-right: darkred solid 1px;
                       text-align:right; text-decoration: underline;}


        div.dvForm {background:Khaki; border: darkblue solid 2px; padding-top:3px; height:30px;
                    font-family:Arial; font-size:10px; text-align:center;}
        select.Small {font-family:Arial; font-size:10px }
        input.Small {margin-top:3px; font-family:Arial; font-size:10px }
        button.Small {margin-top:3px; font-family:Arial; font-size:10px }

        button.Smallest {background:gainsboro; height: 18px; margin-top:5px; font-family:Arial;
                         font-size:10px }

        div.Prompt { position:absolute; visibility:hidden; background-attachment: scroll;
                     background-color:LemonChiffon; border: black solid 2px; width:250; z-index:10;
                     text-align:center; font-size:10px}
        div.dvPO { position:absolute; visibility:hidden; background-attachment: scroll;
              border: black solid 2px; width:250; background-color:LemonChiffon; z-index:10;
              text-align:center; font-size:10px}

        td.BoxName {cursor:move;
              filter:progid:DXImageTransform.Microsoft.Gradient(gradientType=1, startColorStr=MidnightBlue , endColorStr=#a0cfec);
              color:white; text-align:center; font-family:Arial; font-size:12px; font-weight:bold}
        td.BoxClose {cursor:hand;background:#a0cfec;
               color:white; text-align:right; font-family:Arial; font-size:12px; }
        td.Prompt {border-bottom: black solid 2px; border-right: black solid 1px; text-align:center;
                   font-family:Arial; font-size:10px; }

</style>
<SCRIPT language="JavaScript1.2">
//--------------- Global variables -----------------------
//report parameters
var Store = "<%=sStore%>";
var Division = "<%=sDivision%>";
var Department = "<%=sDepartment%>";
var Class = "<%=sClass%>";

//---------------------------------------------------------
// on time of body load
//---------------------------------------------------------
function bodyLoad()
{
   // activate move box
   // activate move box
   setBoxclasses(["BoxName",  "BoxClose"], ["Prompt"]);
}

//---------------------------------------------------------
// show selected record by month
//---------------------------------------------------------
function getOTBbyMonth(grp, grpType)
{
   grp = grp.trim()
   var url = "OpenToBuyMon.jsp?"
      + "STORE=" + Store

      if(grpType=="Division") { url += "&DIVISION=" + grp + "&DEPARTMENT=" + Department + "&CLASS=" + Class }
      else if(grpType=="Department") { url += "&DIVISION=" + Division + "&DEPARTMENT=" + grp + "&CLASS=" + Class }
      else if(grpType=="Class") { url += "&DIVISION=" + Division + "&DEPARTMENT=" + Department + "&CLASS=" + grp }

   //alert(url);
   //window.location.href = url;
   window.frame1.location = url;
}
//---------------------------------------------------------
// show selected record by month
//---------------------------------------------------------
function showOTBbyMon(Grp, GrpName, BegInv, EndInvA, EndInvB, EndVar, LessA, LessB, LessVar,
         MosA, MosB, MosVar, OpnRcvA, OpnRcvB, OpnRcvVar,
         Total, TotBegInv, TotEndInvA, TotEndInvB, TotEndVar, TotLessA, TotLessB, TotLessVar,
         TotMosA, TotMosB, TotMosVar, TotOpnRcvA, TotOpnRcvB, TotOpnRcvVar)
{

   var html = "<table border='0' width='100%' cellPadding='0' cellSpacing='0'>"
      + "<tr>"
       + "<td class='BoxName' nowrap>Monthly Details</td>"
       + "<td class='BoxClose' valign=top>"
         +  "<img src='CloseButton.bmp' onclick='javascript:hidePanel();' alt='Close'>"
       + "</td>"
      + "</tr>"
  // Comment line
   html += "<tr class='DataTable1'>"
          + "<td class='DataTable' nowrap colspan='2'>"
          + "<table class='DataTable' cellPadding='0' cellSpacing='0'>"
          + "<tr>"
          + "<th class='DataTable' rowspan='2'>Month</th>"
          + "<th class='DataTable' rowspan='2'>M<br>o<br>n<br>t<br>h</th>"
          + "<th class='DataTable' rowspan='2'>Beginning<br>Inventory</th>"
          + "<th class='DataTable' rowspan='2'>&nbsp;</th>"
          + "<th class='DataTable' colspan='3'>Open To<br>Receive</th>"
          + "<th class='DataTable' rowspan='2'>&nbsp;</th>"
          + "<th class='DataTable' colspan='3'>Sales<br>Plan</th>"
          + "<th class='DataTable' rowspan='2'>&nbsp;</th>"
          + "<th class='DataTable' colspan='3'>Markdown<br>Of Sales</th>"
          + "<th class='DataTable' rowspan='2'>&nbsp;</th>"
          + "<th class='DataTable' colspan='3'>End of Year<br>Inventory</th>"
        + "</tr>"
        + "<tr>"
          + "<th class='DataTable' nowrap>Plan A</th>"
          + "<th class='DataTable' nowrap>Plan B</th>"
          + "<th class='DataTable' nowrap>&nbsp;Var&nbsp;</th>"
          + "<th class='DataTable' nowrap>Plan A</th>"
          + "<th class='DataTable' nowrap>Plan B</th>"
          + "<th class='DataTable' nowrap>&nbsp;Var&nbsp;</th>"
          + "<th class='DataTable' nowrap>Plan A</th>"
          + "<th class='DataTable' nowrap>Plan B</th>"
          + "<th class='DataTable' nowrap>&nbsp;Var&nbsp;</th>"
          + "<th class='DataTable' nowrap>Plan A</th>"
          + "<th class='DataTable' nowrap>Plan B</th>"
          + "<th class='DataTable' nowrap>&nbsp;Var&nbsp;</th>"
         + "</tr>"

   for(var i=0; i < Grp.length; i++)
   {
       html += "<tr class='DataTable'>"
              + "<td class='DataTable1'>" + GrpName[i] + "</td>"
              + "<th class='DataTable'>&nbsp;</th>"
              + "<td class='DataTable'>" + BegInv[i] + "</td>"
              + "<th class='DataTable'>&nbsp;</th>"
              + "<td class='DataTable'>" + OpnRcvA[i] + "</td>"
              + "<td class='DataTable'>" + OpnRcvB[i] + "</td>"
              + "<td class='DataTable'>" + OpnRcvVar[i] + "</td>"
              + "<th class='DataTable'>&nbsp;</th>"
              + "<td class='DataTable'>" + LessA[i] + "</td>"
              + "<td class='DataTable'>" + LessB[i] + "</td>"
              + "<td class='DataTable'>" + LessVar[i] + "</td>"
              + "<th class='DataTable'>&nbsp;</th>"
              + "<td class='DataTable'> + "MosA[i] + "</td>"
              + "<td class='DataTable'>" + MosB[i] + "</td>"
              + "<td class='DataTable'>" + MosVar[i] + "</td>"
              + "<th class='DataTable'>&nbsp;</th>"
              + "<td class='DataTable'>" + EndInvA[i] + "</td>"
              + "<td class='DataTable'>" + EndInvB[i] + "</td>"
              + "<td class='DataTable'>" + EndVar[i] + "</td>"
             + "</tr>"
   }

   html += "</table></td></tr>"

   // buttons
   html += "<tr class='DataTable1'>"
          + "<td class='DataTable' nowrap colspan='2'>"
          + "<button class='Small' onClick='hidePanel();'>Cancel</button>"
          + "</td>"
        + "</tr>"

   html += "</table>"

   document.all.Prompt.innerHTML = html;
   document.all.Prompt.style.pixelLeft= 200;
   document.all.Prompt.style.pixelTop= 200;
   document.all.Prompt.style.visibility = "visible";

}
//--------------------------------------------------------
// Hide selection screen
//--------------------------------------------------------
function hidePanel()
{
   document.all.Prompt.innerHTML = " ";
   document.all.Prompt.style.visibility = "hidden";
}

//---------------------------------------------------------
//create String method Trim
//---------------------------------------------------------
function String.prototype.trim()
{ //trim leading and trailing spaces
    var s = this;
    var obj = /^(\s*)([\W\w]*)(\b\s*$)/;
    if (obj.test(s)) { s = s.replace(obj, '$2'); }
    var obj = /  /g;
    while (s.match(obj)) { s = s.replace(obj, " "); }
    return s;
}
</SCRIPT>

<script LANGUAGE="JavaScript1.2" src="FormatNumerics.js"></script>
<script LANGUAGE="JavaScript1.2" src="MoveBox.js"></script>


</head>
<body onload="bodyLoad()">
<!-------------------------------------------------------------------->
<iframe
  id="frame1"
  src=""
  frameborder=0 height="0" width="0">
</iframe>
<!-------------------------------------------------------------------->
  <div id="Prompt" class="Prompt"></div>
  <div id="dvPO" class="dvPO"></div>
<!-------------------------------------------------------------------->

    <table border="0" width="100%" cellPadding="0" cellSpacing="0">
     <tr>
      <td ALIGN="center" VALIGN="TOP">
        <b>Retail Concepts, Inc
        <br>Open To Buy Report - End of Year Inventory
        <br>Store: <%=sStore%>
        <br>Division: <%=sDivName%>&nbsp;&nbsp;&nbsp;
            Department: <%=sDptName%>&nbsp;&nbsp;&nbsp;
            Class: <%=sClsName%>
        </b>
      </td>
     </tr>

     <tr>
      <td ALIGN="Center" VALIGN="TOP" colspan=3>


      <a href="/"><font color="red" size="-1">Home</font></a>&#62;
          <a href="OpenToBuyEOYSel.jsp?mode=1">
            <font color="red" size="-1">Open to Buy EOY Selection</font></a>&#62;
          <font size="-1">This Page.</font>
<!-------------------------------------------------------------------->
      <!----------------- beginning of table ------------------------>
      <table class="DataTable" cellPadding="0" cellSpacing="0">
        <tr>
          <th class="DataTable" rowspan="2"><%=sColName%></th>
          <th class="DataTable" rowspan="2">M<br>o<br>n<br>t<br>h</th>
          <th class="DataTable" rowspan="2">Beginning<br>Inventory</th>
          <th class="DataTable" rowspan="2">&nbsp;</th>
          <th class="DataTable" colspan="3">Open To<br>Receive</th>
          <th class="DataTable" rowspan="2">&nbsp;</th>
          <th class="DataTable" colspan="3">Sales<br>Plan</th>
          <th class="DataTable" rowspan="2">&nbsp;</th>
          <th class="DataTable" colspan="3">Markdown<br>Of Sales</th>
          <th class="DataTable" rowspan="2">&nbsp;</th>
          <th class="DataTable" colspan="3">End of Year<br>Inventory</th>
        </tr>
        <tr>
          <th class="DataTable">Plan A</th>
          <th class="DataTable">Plan B</th>
          <th class="DataTable">&nbsp;Var&nbsp;</th>
          <th class="DataTable">Plan A</th>
          <th class="DataTable">Plan B</th>
          <th class="DataTable">&nbsp;Var&nbsp;</th>
          <th class="DataTable">Plan A</th>
          <th class="DataTable">Plan B</th>
          <th class="DataTable">&nbsp;Var&nbsp;</th>
          <th class="DataTable">Plan A</th>
          <th class="DataTable">Plan B</th>
          <th class="DataTable">&nbsp;Var&nbsp;</th>
        </tr>
<!------------------------------- Data Detail --------------------------------->
           <%for(int i=0; i < iNumOfGrp; i++) {%>
              <tr class="DataTable">
                <td class="DataTable1"><%=sGrp[i] + " - " + sGrpName[i]%></td>
                <th class="DataTable"><a href="javascript: getOTBbyMonth('<%=sGrp[i]%>', '<%=sColName%>')" class="blue">M</a></th>
                <td class="DataTable"><%=sBegInv[i]%></td>
                <th class="DataTable">&nbsp;</th>
                <td class="DataTable"><%=sOpnRcvA[i]%></td>
                <td class="DataTable"><%=sOpnRcvB[i]%></td>
                <td class="DataTable"><%=sOpnRcvVar[i]%></td>
                <th class="DataTable">&nbsp;</th>
                <td class="DataTable"><%=sLessA[i]%></td>
                <td class="DataTable"><%=sLessB[i]%></td>
                <td class="DataTable"><%=sLessVar[i]%></td>
                <th class="DataTable">&nbsp;</th>
                <td class="DataTable"><%=sMosA[i]%></td>
                <td class="DataTable"><%=sMosB[i]%></td>
                <td class="DataTable"><%=sMosVar[i]%></td>
                <th class="DataTable">&nbsp;</th>
                <td class="DataTable"><%=sEndInvA[i]%></td>
                <td class="DataTable"><%=sEndInvB[i]%></td>
                <td class="DataTable"><%=sEndVar[i]%></td>
             </tr>
          <%}%>
<!------------------- Company Total -------------------------------->
             <tr class="DataTable2">
                <td class="DataTable1"><%=sTotal%></td>
                <th class="DataTable">&nbsp;</th>
                <td class="DataTable"><%=sTotBegInv%></td>
                <th class="DataTable">&nbsp;</th>
                <td class="DataTable"><%=sTotOpnRcvA%></td>
                <td class="DataTable"><%=sTotOpnRcvB%></td>
                <td class="DataTable"><%=sTotOpnRcvVar%></td>
                <th class="DataTable">&nbsp;</th>
                <td class="DataTable"><%=sTotLessA%></td>
                <td class="DataTable"><%=sTotLessB%></td>
                <td class="DataTable"><%=sTotLessVar%></td>
                <th class="DataTable">&nbsp;</th>
                <td class="DataTable"><%=sTotMosA%></td>
                <td class="DataTable"><%=sTotMosB%></td>
                <td class="DataTable"><%=sTotMosVar%></td>
                <th class="DataTable">&nbsp;</th>
                <td class="DataTable"><%=sTotEndInvA%></td>
                <td class="DataTable"><%=sTotEndInvB%></td>
                <td class="DataTable"><%=sTotEndVar%></td>
             </tr>
      </table>
      <!----------------------- end of table ------------------------>
  </table>
 </body>
</html>
