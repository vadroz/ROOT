<!DOCTYPE html>	
<%@ page import="mozu_com.MozuOrSTSList, java.util.*, java.text.*"%>
<%
String sSelStr = request.getParameter("Str");
   
//----------------------------------
// Application Authorization
//----------------------------------
if (session.getAttribute("USER")==null)
{
     response.sendRedirect("SignOn1.jsp?TARGET=MozuOrSTSList.jsp&APPL=ALL&" + request.getQueryString());
}
else
{	
	String sUser = session.getAttribute("USER").toString();
	
	MozuOrSTSList orstsl = new MozuOrSTSList(sSelStr);	
%>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE10" />
<LINK href="style/Page_0001.css" rel="stylesheet" type="text/css">

<title>S-T-S_Ord_List</title>

<SCRIPT>

//--------------- Global variables -----------------------
var SelStr = "<%=sSelStr%>";
//--------------- End of Global variables ----------------
//==============================================================================
// initial process
//==============================================================================
function bodyLoad()
{
   setBoxclasses(["BoxName",  "BoxClose"], ["dvItem"]);
}
//==============================================================================
//show fedex data
//==============================================================================
function setPropValue(id, type, prop, attr, value )
{
	var hdr = "Update " + prop
	   var html = "<table border=0 width='100%' cellPadding=0 cellSpacing=0>"
	     + "<tr>"
	       + "<td class='BoxName' nowrap>" + hdr + "</td>"
	       + "<td class='BoxClose' valign=top>"
	         +  "<img src='CloseButton.bmp' onclick='javascript:hidePanel();' alt='Close'>"
	       + "</td></tr>"
	     + "<tr><td class='Prompt' colspan=2>" + popPropValue(id, type, prop, value )
	       + "</td></tr>"
	     + "</table>"

	  document.all.dvItem.style.width=500;
	  document.all.dvItem.innerHTML = html;
	  document.all.dvItem.style.pixelLeft=document.documentElement.scrollLeft + 300;
	  document.all.dvItem.style.pixelTop=document.documentElement.scrollTop + 20;
	  document.all.dvItem.style.visibility = "visible";
	  
	  document.all.Prop.value = value.trim();
	  document.all.Id.value = id;
	  
	  if(type=="LIST") { rtvAttrLst(attr); }
	}
	//==============================================================================
	// populate panel
	//==============================================================================
	function popPropValue(id, type, prop, value )
	{		   
	   var panel = "<table class='tbl01' id='tblLog'>"
	    + "<tr>"
	       + "<td class='td08'>";
	    if(type=="LIST")  
	    { 
	    	panel += "<input name='Prop' maxlength=50 size=50 readOnly>"
	    	 + "<br><br>Select:<select name='selOpt' onchange='setSelProp(this)'></select>"
	    }	    
	    else if(type=="TEXT")
	    {
	    	panel += "<TextArea class='Small' name='Prop' cols=100 rows=10></TextArea>";
	    }
	    panel += "<input type='hidden' name='Id'>";	     
	    panel += "</td>";	       
	    panel += "</tr>";  
	    
		panel += "</table> <br/>";
	    panel += "<tr>"
  		  + "<td id='tdError' class='Small' colspan=2 style='color:red;font-size:12px;'></td>"
		   + "</tr>";
		   
	    panel += "</table>"
	        + "<button onClick='vldPropValue();' class='Small'>Save Changes</button>&nbsp; &nbsp;"
	        + "<button onClick='hidePanel();' class='Small'>Close</button>&nbsp;"
	    ;
	        
		return panel;
}
//==============================================================================
//validate new value
//==============================================================================
function vldPropValue()
{
	var error = false;
  	var msg = "";
  	document.all.tdError.innerHTML="";

  	var id = document.all.Id.value.trim();
  	var prop = document.all.Prop.value;
  	var i = prop.indexOf("\n");  
  	prop = prop.replace(/\n/g, "\\n");
  	
  	if(error){ document.all.tdError.innerHTML=msg; }
  	else{ sbmPropValue(id, prop); }
}
//==============================================================================
//submit store status changes
//==============================================================================
function sbmPropValue(id, prop)
{
	
  	var nwelem = window.frame1.document.createElement("div");
  	nwelem.id = "dvSbmStrSts"
  	
  	var html = "<form name='frmItmProp'"
     + " METHOD=Post ACTION='MozuParentSave.jsp'>"
     + "<input name='Site'>"
     + "<input name='Cls'>"
     + "<input name='Ven'>"
     + "<input name='Sty'>"
     + "<input name='Id'>"
     + "<input name='Prop'>"       
     + "<input name='Action'>"

  	html += "</form>"
  	
  		
  	nwelem.innerHTML = html;
  	window.frame1.document.body.appendChild(nwelem);

  	window.frame1.document.all.Cls.value = Cls;
  	window.frame1.document.all.Ven.value = Ven;
  	window.frame1.document.all.Sty.value = Sty;
  	window.frame1.document.all.Id.value = id;
  	window.frame1.document.all.Prop.value = prop;
  	window.frame1.document.all.Action.value="SvItemProp";
  
  	window.frame1.document.frmItmProp.submit();
}
//==============================================================================
//Hide selection screen
//==============================================================================
function hidePanel()
{
	document.all.dvItem.innerHTML = " ";
	document.all.dvItem.style.visibility = "hidden";
}
//==============================================================================
// mark Item as Received or handled
//==============================================================================
function markItem(sku, sn, action)
{
	alert(sku + "|" + sn + "|" + action)
}
</SCRIPT>
<script src="StrSelBox.js"></script>
<script src="MoveBox.js"></script>
<script src="String_Trim_function.js"></script>
<script src="Get_Object_Position.js"></script>
<script src="Calendar.js"></script>

</head>
<body onload="bodyLoad()">
<!-------------------------------------------------------------------->
<div id="dvItem" class="dvItem"></div>
<!-------------------------------------------------------------------->
<iframe  id="frame1"  src=""  frameborder=0 height="0" width="0"></iframe>
<!-------------------------------------------------------------------->

<!-------------------------------------------------------------------->
      <!----------------- beginning of table ------------------------>
      <table class="tbl01">
        <tr class="trHdr">
          <th colspan=45>
            <b>Retail Concepts, Inc
            <br>Mozu - Ship-To-Store Order List    
            </b>
            
            <br>
              <a href="/"><font color="red" size="-1">Home</font></a>&#62;
              <font size="-1">This Page.</font> &nbsp; &nbsp; &nbsp; &nbsp;            
          </th>
        </tr>
        <tr>
          <td>  
       
          
      <!-- ======================================================================= -->    
          
          
      <table class="tbl02">
      	<tr id="trId" class="trHdr01">
           <th class="th01" nowrap>Order #</th>
           <th class="th01" nowrap>Picked By</th>
           <th class="th01" nowrap>Ship To</th>
           <th class="th01" nowrap>Completed</th>
           <th class="th01" nowrap>Home<br>Phone</th>
           <th class="th01" nowrap>Mobile<br>Phone</th>
           <th class="th01" nowrap>Work<br>Phone</th>
        </tr>
<!------------------------------- Detail --------------------------------->
        <%while(orstsl.getNext()){
         	orstsl.getOrder();
            String sSite = orstsl.getSite();
            String sOrd = orstsl.getOrd();
            String sStr = orstsl.getStr();
            String sCust = orstsl.getCust();
            String sCompl = orstsl.getCompl();
            String sComplDt = orstsl.getComplDt();
            String sComplTm = orstsl.getComplTm();
            String sPickBy = orstsl.getPickBy();
            String sFirstNm = orstsl.getFirstNm();
            String sLastNm = orstsl.getLastNm();       
            String sPhnHome = orstsl.getPhnHome();
            String sPhnMob = orstsl.getPhnMob();
            String sPhnWork = orstsl.getPhnWork();
            
            int iNumOfPack = orstsl.getNumOfPack();
         %>
         <tr id="trId" class="trDtl04">
            <td class="td04" nowrap rowspan="<%=2%>"><%=sOrd%></td>
            <td class="td05" nowrap><%=sPickBy%></td>
            <td class="td05" nowrap><%=sFirstNm%> <%=sLastNm%></td>
            <td class="td05" nowrap>&nbsp; <%if(sCompl.equals("Y")){%><%=sCompl%> <%=sComplDt%> <%=sComplTm%><%}%></td>
            <td class="td05" nowrap><%=sPhnHome%></t>
            <td class="td05" nowrap><%=sPhnMob%></td>
            <td class="td05" nowrap><%=sPhnWork%></td>
         </tr>
         <tr id="trId" class="trDtl04">
            <td class="td04" colspan=6>
            	<table class="tbl01">
      				<tr id="trId" class="trHdr02">
           				<th class="th01" nowrap>SKU</th>
           				<th class="th01" nowrap>Serial<br>Number</th>
           				<th class="th01" nowrap>Description</th>
           				<th class="th01" nowrap>Vendor Name</th>
           				<th class="th01" nowrap>UPS</th>
           				<th class="th01" nowrap>Received By Store</th>
           				<th class="th01" nowrap>Handling</th>   				
      				</tr>
      				<%for(int i=0; i < iNumOfPack; i++) {
      				   orstsl.getPackLst();
      		    	   String sSku = orstsl.getSku();
      		    	   String sSrlN = orstsl.getSrlN();
      		    	   String sDesc = orstsl.getDesc();
      		    	   String sVenNm = orstsl.getVenNm();
      		    	   String sUps = orstsl.getUps();
      		    	   String sRcv = orstsl.getRcv();
      		    	   String sRcvDt = orstsl.getRcvDt();
      		    	   String sRcvTm = orstsl.getRcvTm();
      		    	   String sHdl = orstsl.getHdl();
      		    	   String sHdlDt = orstsl.getHdlDt();
      		    	   String sHdlTm = orstsl.getHdlTm();
      		    	   String sPack = orstsl.getPack();
      				%>
      				<tr id="trId" class="trDtl06">
            			<td class="td04" nowrap><%=sSku%></td>
            			<td class="td04" nowrap><%=sSrlN%></td>
            			<td class="td05" nowrap><%=sDesc%></td>
            			<td class="td05" nowrap><%=sVenNm%></td>
            			<td class="td06" nowrap><%=sUps%></td>
            			<td class="td06" nowrap>
            				<%if(sRcv.equals("Y")){%><%=sRcvDt%> <%=sRcvTm%><%}
            				else {%><input onclick="markItem('<%=sSku%>', '<%=sSrlN%>','Received')" type="checkbox" value="Y"><%}%>
            			</td>
            			<td class="td04" nowrap>
            			     <%if(sHdl.equals("Y")){%><%=sHdlDt%> <%=sHdlTm%><%}
            			     else if(sRcv.equals("Y")){%><input onclick="markItem('<%=sSku%>', '<%=sSrlN%>','Handled')" type="checkbox" value="Y"><%}%>
            			</td>
            		</tr>
      				<%}%>
      			</table>
            </td>
         </tr>
         <tr><td class="Separator02" colspan=7>&nbsp;</td></tr>
         <%}%>
         </table>
      <!----------------------- end of table ------------------------>
      </tr>
   </table>
 </body>
</html>
<%
orstsl.disconnect();
orstsl = null;
}
%>